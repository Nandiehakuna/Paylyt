{"ast":null,"code":"import React,{useState,useEffect,useContext}from'react';import axios from'axios';import ProposalModal from'../components/ProposalModal';import{AuthContext}from'../context/AuthContext';import{useHistory}from'react-router-dom';// Import useHistory\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const JobDetailPage=_ref=>{let{match}=_ref;const[job,setJob]=useState(null);const[proposals,setProposals]=useState([]);const[modalIsOpen,setModalIsOpen]=useState(false);const{user}=useContext(AuthContext);const history=useHistory();// Initialize useHistory\nuseEffect(()=>{const fetchJobAndProposals=async()=>{try{const jobRes=await axios.get(\"/api/jobs/\".concat(match.params.id));setJob(jobRes.data);const proposalsRes=await axios.get(\"/api/jobs/\".concat(match.params.id,\"/proposals\"));setProposals(proposalsRes.data);}catch(err){console.error(err);}};fetchJobAndProposals();},[match.params.id]);const openModal=()=>{setModalIsOpen(true);};const closeModal=()=>{setModalIsOpen(false);};const handleAcceptProposal=async proposalId=>{try{const res=await axios.post(\"/api/contracts\",{jobId:job.id,proposalId});history.push(\"/contracts/\".concat(res.data.id));// Redirect to contract page\n}catch(err){console.error(err.response.data);// Handle contract creation error\n}};if(!job){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}const isClient=user&&user.id===job.clientId;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:job.title}),/*#__PURE__*/_jsx(\"p\",{children:job.description}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Budget: $\",job.budget]}),isClient?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Proposals\"}),proposals.map(proposal=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:proposal.coverLetter}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Proposed Rate: $\",proposal.proposedRate]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAcceptProposal(proposal.id),children:\"Accept Proposal\"})]},proposal.id))]}):/*#__PURE__*/_jsx(\"button\",{onClick:openModal,children:\"Submit Proposal\"}),/*#__PURE__*/_jsx(ProposalModal,{isOpen:modalIsOpen,onRequestClose:closeModal,jobId:job.id})]});};export default JobDetailPage;","map":{"version":3,"names":["React","useState","useEffect","useContext","axios","ProposalModal","AuthContext","useHistory","jsx","_jsx","jsxs","_jsxs","JobDetailPage","_ref","match","job","setJob","proposals","setProposals","modalIsOpen","setModalIsOpen","user","history","fetchJobAndProposals","jobRes","get","concat","params","id","data","proposalsRes","err","console","error","openModal","closeModal","handleAcceptProposal","proposalId","res","post","jobId","push","response","children","isClient","clientId","title","description","budget","map","proposal","coverLetter","proposedRate","onClick","isOpen","onRequestClose"],"sources":["/home/user/Paylyt/paylyt-platform/frontend/src/pages/JobDetailPage.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport axios from 'axios';\nimport ProposalModal from '../components/ProposalModal';\nimport { AuthContext } from '../context/AuthContext';\nimport { useHistory } from 'react-router-dom'; // Import useHistory\n\nconst JobDetailPage = ({ match }) => {\n  const [job, setJob] = useState(null);\n  const [proposals, setProposals] = useState([]);\n  const [modalIsOpen, setModalIsOpen] = useState(false);\n  const { user } = useContext(AuthContext);\n  const history = useHistory(); // Initialize useHistory\n\n  useEffect(() => {\n    const fetchJobAndProposals = async () => {\n      try {\n        const jobRes = await axios.get(`/api/jobs/${match.params.id}`);\n        setJob(jobRes.data);\n\n        const proposalsRes = await axios.get(`/api/jobs/${match.params.id}/proposals`);\n        setProposals(proposalsRes.data);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    fetchJobAndProposals();\n  }, [match.params.id]);\n\n  const openModal = () => {\n    setModalIsOpen(true);\n  };\n\n  const closeModal = () => {\n    setModalIsOpen(false);\n  };\n\n  const handleAcceptProposal = async (proposalId) => {\n    try {\n      const res = await axios.post(`/api/contracts`, { \n        jobId: job.id, \n        proposalId \n      });\n      history.push(`/contracts/${res.data.id}`); // Redirect to contract page\n    } catch (err) {\n      console.error(err.response.data);\n      // Handle contract creation error\n    }\n  };\n\n  if (!job) {\n    return <div>Loading...</div>;\n  }\n\n  const isClient = user && user.id === job.clientId;\n\n  return (\n    <div>\n      <h2>{job.title}</h2>\n      <p>{job.description}</p>\n      <p>Budget: ${job.budget}</p>\n\n      {isClient ? (\n        <div>\n          <h3>Proposals</h3>\n          {proposals.map((proposal) => (\n            <div key={proposal.id}>\n              <p>{proposal.coverLetter}</p>\n              <p>Proposed Rate: ${proposal.proposedRate}</p>\n              <button onClick={() => handleAcceptProposal(proposal.id)}>Accept Proposal</button>\n            </div>\n          ))}\n        </div>\n      ) : (\n        <button onClick={openModal}>Submit Proposal</button>\n      )}\n\n      <ProposalModal isOpen={modalIsOpen} onRequestClose={closeModal} jobId={job.id} />\n    </div>\n  );\n};\n\nexport default JobDetailPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}