{"ast":null,"code":"var _jsxFileName = \"/home/user/Paylyt/paylyt-platform/frontend/src/pages/JobDetailPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from 'react';\nimport axios from 'axios';\nimport ProposalModal from '../components/ProposalModal';\nimport { AuthContext } from '../context/AuthContext';\nimport { useHistory } from 'react-router-dom'; // Import useHistory\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst JobDetailPage = ({\n  match\n}) => {\n  _s();\n  const [job, setJob] = useState(null);\n  const [proposals, setProposals] = useState([]);\n  const [modalIsOpen, setModalIsOpen] = useState(false);\n  const {\n    user\n  } = useContext(AuthContext);\n  const history = useHistory(); // Initialize useHistory\n\n  useEffect(() => {\n    const fetchJobAndProposals = async () => {\n      try {\n        const jobRes = await axios.get(`/api/jobs/${match.params.id}`);\n        setJob(jobRes.data);\n        const proposalsRes = await axios.get(`/api/jobs/${match.params.id}/proposals`);\n        setProposals(proposalsRes.data);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n    fetchJobAndProposals();\n  }, [match.params.id]);\n  const openModal = () => {\n    setModalIsOpen(true);\n  };\n  const closeModal = () => {\n    setModalIsOpen(false);\n  };\n  const handleAcceptProposal = async proposalId => {\n    try {\n      const res = await axios.post(`/api/contracts`, {\n        jobId: job.id,\n        proposalId\n      });\n      history.push(`/contracts/${res.data.id}`); // Redirect to contract page\n    } catch (err) {\n      console.error(err.response.data);\n      // Handle contract creation error\n    }\n  };\n  if (!job) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 12\n    }, this);\n  }\n  const isClient = user && user.id === job.clientId;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: job.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: job.description\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Budget: $\", job.budget]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), isClient ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Proposals\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 11\n      }, this), proposals.map(proposal => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: proposal.coverLetter\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Proposed Rate: $\", proposal.proposedRate]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleAcceptProposal(proposal.id),\n          children: \"Accept Proposal\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 15\n        }, this)]\n      }, proposal.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 13\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: openModal,\n      children: \"Submit Proposal\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(ProposalModal, {\n      isOpen: modalIsOpen,\n      onRequestClose: closeModal,\n      jobId: job.id\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n};\n_s(JobDetailPage, \"kfVtvSiu7JW0bF7t/p+d0wKnWg8=\", false, function () {\n  return [useHistory];\n});\n_c = JobDetailPage;\nexport default JobDetailPage;\nvar _c;\n$RefreshReg$(_c, \"JobDetailPage\");","map":{"version":3,"names":["React","useState","useEffect","useContext","axios","ProposalModal","AuthContext","useHistory","jsxDEV","_jsxDEV","JobDetailPage","match","_s","job","setJob","proposals","setProposals","modalIsOpen","setModalIsOpen","user","history","fetchJobAndProposals","jobRes","get","params","id","data","proposalsRes","err","console","error","openModal","closeModal","handleAcceptProposal","proposalId","res","post","jobId","push","response","children","fileName","_jsxFileName","lineNumber","columnNumber","isClient","clientId","title","description","budget","map","proposal","coverLetter","proposedRate","onClick","isOpen","onRequestClose","_c","$RefreshReg$"],"sources":["/home/user/Paylyt/paylyt-platform/frontend/src/pages/JobDetailPage.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport axios from 'axios';\nimport ProposalModal from '../components/ProposalModal';\nimport { AuthContext } from '../context/AuthContext';\nimport { useHistory } from 'react-router-dom'; // Import useHistory\n\nconst JobDetailPage = ({ match }) => {\n  const [job, setJob] = useState(null);\n  const [proposals, setProposals] = useState([]);\n  const [modalIsOpen, setModalIsOpen] = useState(false);\n  const { user } = useContext(AuthContext);\n  const history = useHistory(); // Initialize useHistory\n\n  useEffect(() => {\n    const fetchJobAndProposals = async () => {\n      try {\n        const jobRes = await axios.get(`/api/jobs/${match.params.id}`);\n        setJob(jobRes.data);\n\n        const proposalsRes = await axios.get(`/api/jobs/${match.params.id}/proposals`);\n        setProposals(proposalsRes.data);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    fetchJobAndProposals();\n  }, [match.params.id]);\n\n  const openModal = () => {\n    setModalIsOpen(true);\n  };\n\n  const closeModal = () => {\n    setModalIsOpen(false);\n  };\n\n  const handleAcceptProposal = async (proposalId) => {\n    try {\n      const res = await axios.post(`/api/contracts`, { \n        jobId: job.id, \n        proposalId \n      });\n      history.push(`/contracts/${res.data.id}`); // Redirect to contract page\n    } catch (err) {\n      console.error(err.response.data);\n      // Handle contract creation error\n    }\n  };\n\n  if (!job) {\n    return <div>Loading...</div>;\n  }\n\n  const isClient = user && user.id === job.clientId;\n\n  return (\n    <div>\n      <h2>{job.title}</h2>\n      <p>{job.description}</p>\n      <p>Budget: ${job.budget}</p>\n\n      {isClient ? (\n        <div>\n          <h3>Proposals</h3>\n          {proposals.map((proposal) => (\n            <div key={proposal.id}>\n              <p>{proposal.coverLetter}</p>\n              <p>Proposed Rate: ${proposal.proposedRate}</p>\n              <button onClick={() => handleAcceptProposal(proposal.id)}>Accept Proposal</button>\n            </div>\n          ))}\n        </div>\n      ) : (\n        <button onClick={openModal}>Submit Proposal</button>\n      )}\n\n      <ProposalModal isOpen={modalIsOpen} onRequestClose={closeModal} jobId={job.id} />\n    </div>\n  );\n};\n\nexport default JobDetailPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}